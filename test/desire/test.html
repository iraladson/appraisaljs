<!DOCTYPE HTML>
<html>
<head>
<script src="lexicon.js_"></script>
<script src="lexer.js"></script>
<script src="POSTagger.js"></script>
<script src="EMOAPP.js"></script>
<script src="IntentionEMOAPP.js"></script>
<script src="BeliefEMOAPP.js"></script>
<script src="DesireEMOAPP.js"></script>
<script type="text/javascript">
 	var that = this;
	var model = new EMOAPP.Core()
	var belief = new EMOAPP.Belief();
	var intent = new EMOAPP.Intention();
	var desire = new EMOAPP.WilliamDesire();

	model.addComponent(intent);
	model.addComponent(belief);
	model.addComponent(desire);
	model.linkComponents();

	function updater(sentence,sentiment,self,modules){
		var obj = {};
		obj.sentence = sentence;
		obj.sentiment = sentiment;
		obj.self = self;
		console.log(modules);

		for(var i = 0; i < modules.length; i += 1){
			//console.log(modules[i].getId());
			console.log(modules[i])
			modules[i].update(obj)
		}
	}
</script>
</head>
<body>	
	<div id='chatArea' style='border:1px solid #aaa; width:500px; height:400px; overflow:auto;'></div>  
	<form>
 	  <textarea id = "answer" placeholder="Some text in this box." rows="2" cols="50"></textarea>
      <br>
      <left><a onClick = "sendText()" href="javascript:void(0);" title="Answer">Submit</a></left>               
    </form>
</body>
<script>  
	function sendText(){
	var input = document.getElementById('answer');
	var text = input.value;
	//console.log(text);
	updater(text,getSentiment(text),false,[intent,belief,desire])
	var affect = model.process();
	console.log(affect);
	//updater("",0,true,[intent])
}
   </script>
</html>


<script type="text/javascript">
function test(){
	

	
/*
	console.log("~~|||Greeting|||~~~");
	updater("Hi",0.1,true,[intent]);
	updater("Hey!",0.1,false,[belief,intent,desire]);
	model.process();

	console.log("~~|||Question On Question|||~~~");
	updater("Is the sky blue?",0.1,true,[intent]);
	updater("What is your mother's name?",0.1,false,[belief,intent,desire]);
	console.log(model.process());

	console.log("~~|||Mean|||~~~");
	updater("I like flowers.",0.1,true,[intent]);
	desire.newDesire({
		context : that,
		value : function(){return},
		lastValue : 0,
		valueIsMethod : false,
		param : "flowers",
		direction : 1
	});
	updater("Flowers are bad!",-0.7,false,[belief,intent,desire]);
	console.log(model.process());

	return belief.getBeliefs();

	console.log("~~|||Nice|||~~~");
	updater("How do I look?",0.1,true,[intent]);
	updater("You are very pretty",0.6,false,[belief,intent,desire]);
	console.log(model.process());
	var x = model.process()
	x.mood = [x,y]
*/
	console.log("~~|||Factoid|||~~~");
	updater("What is water?",0.1,true,[intent]);
	updater("It's a liquid that's found everywhere",0.1,false,[belief,intent,desire]);
	console.log(model.process());

}

function getSentiment(sentence){

	var negations = new RegExp("^(never|nothing|nowhere|noone|none|not|haven't|hasn't|hadn't|can't'|couldn't|shouldn't|won't|wouldn't|don't|doesn't|didn't|isn't|aren't|ain't)$");

	var pos_lex = new RegExp("^(❤️|no problem|ya!|happy|excited|joyful|delighted|good|pleased|content|satisfied|euphoric|joy|overjoyed|jubilant|high|glad|pleased|willing|ready|fortunate|lucky|favor|favorable|advantage|advantageous|fortunate|fortune|delight|opportune|convenient|appropriate|fulfilled|enthusiastic|pleasing|positive|propitious|auspicious|thank|promising|encouraging|affirmative|affirmation|agree|agreeing|approve|approving|encourage|encouraging|agree|agreeing|united|approve|accept|acceptance|coincide|harmony|harmonize|good|deal|concur|beautiful|attractive|pretty|good|looking|appealing|engaging|glamorous|ravishing|gorgeous|stunning|elegant|exquisite|artistic|magnificent|divine|foxy|sexy|cute|smang|dime|model|handsome|alluring|interest|interested|engaging|striking|fetching|dapper|enchanting|enticing|delightful|winning|photogenic|irresistible|ravishing|desirable|fair|cool|hot|trendy|hip|happening|nice|poised|serene|coolest|chic|sophisticated|interesting|alive|yaaaas|skilled|killed|clean|pristine|auspicious|ill|mature|calm|true|worth|valid|yes|yup|yep|yea|yeah|yah|love|yeses|yessssss|yesyesyes|ok|k|okay|ok!|kewl|good-crazy|rules|owns|ballin|beautiful)$"); 

	var neu_lex = new RegExp("^(crazy|wierd)$");	 

	var neg_lex = new RegExp("^(bad|wrong|lazy|stupid|dumb|boring|dull|monotonous|repetitive|unimaginative|insipid|uninteresting|lifeless|dead|bland|flat|unreadable|banal|lackluster|stodgy|vapid|tiring|irksome|trying|frustrating|lose|losing|deadly|vanilla|plain|substandard|poor|inferior|second|rate|unsatisfactory|deficient|imperfect|defective|faulty|incompetent|inept|awful|terrible|appalling|atrocious|godawful|rotten|pathetic|useless|bum|lousey|hurtful|corrupt|reprobate|amoral|unethical|dishonest|dishonorable|dirty|insubordinate|undisciplined|dreadful|disgusting|stress|stressful|crowded|unpleasant|smelly|unfortunate|ugly|adverse|inappropriate|minor|severe|grave|dead|putrid|odd|moldy|sour|rotten|rancid|spoiled|rank|stinky|beefy|guilty|guilt|ashamed|contrite|sorry|regret|regretful|childish|immature|phony|bologna|worthless|fake|false|invalid|no|hell|no|bad-crazy|sucks)$");





	/*var score;
	var result = [];
	var factor = 1;   */

	//tokenize input text 
	function tokenizeInput(text){
		var score;
		var factor = 1;
		var factorsToIgnore = 0;
		var result = [];
		var _text = text.trim().split(" ");
		for (var i = 0; i < _text.length; i++) 
		{   
		   score = 0.0;
			
		var	msg = _text[i].replace("'", "");
			msg = _text[i].match(/\b\w+\b/g);
			msg = _text[i].toLowerCase();
		var res = msg.split(" ");

			for( var j = 0; j < res.length; j++)
			{
		      if(res[j].match(negations))
		      {
		      	if(typeof res[j] !== 'undefined') 
	            	//text[i] = "!" + text[i];
	            	factor *= -1;
	            	factorsToIgnore += 1;
		      }
		      score = Sentiment(res[j],score);

		    }
		  score = score/res.length;
		  score = score.toFixed(2);
		  var total = result.push(score);
	    }
	   
	   var sentiment = 0;

	   	for(var x = 0; x < result.length; x += 1){
	   		sentiment += parseInt(result[x]);
	   	}
	   	return (sentiment/(result.length - factorsToIgnore)) * factor;
	 }
	 
	function Sentiment(word,score)

	{
		//if word matches anything in postive/negative lexicons add +1 or -1 to score
		if(word !== 'undefined') 
		{
			if(word.match(pos_lex)) score++ ;
			if(word.match(neg_lex)) score-- ;
			else score = score + 0;
			//console.log(score);

			return score
		}
	}

	return tokenizeInput(sentence);
}



</script>

